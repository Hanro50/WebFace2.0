<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="/css/table.css">
</head>

<body>
    <h1>Edit services</h1>
    <hr>
    <div class="button" onclick="window.location.href='./list.html'">Back</div>

    <table id="table">
        <tr>
            <th>
                <div>DNS Address</div>
            </th>
            <th>
                <div>Settings</div>
            </th>
        </tr>
        <tr>
            <td>
                <div>Name</div>
            </td>
            <td>
                <div><input ID="Name" required></input></div>
            </td>
        </tr>
        <tr>
            <td>
                <div>Excution path</div>
            </td>
            <td>
                <div><input ID="Path"></input></div>
            </td>
        </tr>
        <tr>
            <td>
                <div>Start at Startup</div>
            </td>
            <td>
                <div><input type="checkbox" ID="Startup"></input></div>
            </td>
        </tr>
        <tr>
            <td>
                <div>Run as root</div>
            </td>
            <td>
                <div><input type="checkbox" ID="Root"></input></div>
            </td>
        </tr>
        <tr>
            <td>
                <div>Advance mode</div>
            </td>
            <td>
                <div><input ID="AdvanceSwitch" type="checkbox" onclick="toggle()"></input></div>
            </td>
        </tr>
        <tr id="bas">
            <td>
                <div>Basic script</div>
            </td>
            <td>
                <div><textarea ID="Basic"></textarea></div>
            </td>
        </tr>
        <tr id="adv" hidden>
            <td>
                <div>Advance script</div>
            </td>
            <td class="b" ID="Advance">
                <div>Select file (no file selected)</div>
            </td>
        </tr>
        <tr>
            <td>
                <div>Description</div>
            </td>
            <td>
                <div><textarea ID="Description"></textarea></div>
            </td>
        </tr>
        <tr>
            <td>
                <div>Save changes</div>
            </td>
            <td class="b">
                <div onclick="save()">Save</div>
            </td>
        </tr>
    </table>
    <script>
        const dat = new Map;

        ["Name", "Path", "Advance", "Startup", "Root", "AdvanceSwitch", "Basic", "Advance", "Description"].forEach(e => {
            dat.set(e, document.getElementById(e));
        })

        function toggle() {
            const advance_gui = document.getElementById("adv");
            const basic_gui = document.getElementById("bas");
            basic_gui.hidden = !basic_gui.hidden;
            advance_gui.hidden = !advance_gui.hidden;
        }

        function save() {
            const forum = {};
            const keyz = Array.from(dat.keys());
            setTimeout(() => {


                let c = ["#ff1717", "#fd1717", "#dd1717", "#de1717", "#ee1717", "#bb1717", "#aa1717", "#991717", "#881717", "#771717", "#661717","#551717", "#441717", "#331717", "#221717", "#171717", ""]
                const inter = setInterval(() => {
                    if (c.length > 0) {
                        const clr = c.shift();
                        dat.forEach(v => {
                            if (v.parentNode.parentNode.style.backgroundColor !== "")
                                v.parentNode.parentNode.style.backgroundColor = clr;
                        })
                    } else
                        clearInterval(inter)
                }, 50)
            }, 100)
            for (var i = 0; i < keyz.length; i++) {
                const k = keyz[i];
                const v = dat.get(k);
                console.log(dat)
                if (v instanceof HTMLInputElement || v instanceof HTMLTextAreaElement) {
                    console.log(v.hidden)
                    if (!v.hidden) {
                        if (v.required && v.value.trim().length < 1) {
                            v.parentNode.parentNode.style.backgroundColor = "#ff0000";
                            return;
                        }
                        console.log(v.required)
                        forum[k] = v.value;

                    }
                }

            }
            console.log(forum);

        }

        Array.from(document.getElementsByTagName("div")).forEach(element => {
            const e = element.firstElementChild;
            if (e instanceof HTMLInputElement && e.type == "checkbox") {
                (element.parentElement || element).onclick = () => e.click();
                e.style.pointerEvents = "none";
            }
        });

    </script>
</body>

</html>